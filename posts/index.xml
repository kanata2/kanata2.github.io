<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on back of flyer</title><link>https://kanata2.dev/posts/</link><description>Recent content in Posts on back of flyer</description><generator>Hugo 0.75.1 -- gohugo.io</generator><language>ja</language><lastBuildDate>Fri, 25 Dec 2020 02:27:52 +0900</lastBuildDate><atom:link href="https://kanata2.dev/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>Snowflake のリソースモニター通知を Slack で受け取る</title><link>https://kanata2.dev/posts/2020-12-25-snowflake-resource-monitor-noti/</link><pubDate>Fri, 25 Dec 2020 02:27:52 +0900</pubDate><guid isPermaLink="true">https://kanata2.dev/posts/2020-12-25-snowflake-resource-monitor-noti/</guid><description>&lt;p>Snowflake にはコスト管理や予期しない使用状況回避のためにリソースモニターという仕組みがあるが、&lt;br>
現状アカウント管理者に Web インターフェイスまたはメールを通してのみ通知される点がちょっと使いづらい。&lt;br>
というわけで、この通知を Slack に流して誰でも確認できるようにしているよという tips メモを残しておく。&lt;/p>
&lt;p>Slack には&lt;a href="https://slack.com/help/articles/206819278-Send-emails-to-Slack">チャンネルにメールを流す仕組み&lt;/a>があるので、これを使う。&lt;br>
手順に従って取得したメールアドレスを ACCOUNTADMIN ロールを持つユーザのメールアドレスとして設定し、ウェブ上から通知を有効化・電子メール受け取りに変更するのみ。&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="k">alter&lt;/span> &lt;span class="k">user&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">admin_user&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="k">set&lt;/span> &lt;span class="n">email&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;x-hoge@xxx.org.slack.com&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>これだけ。&lt;br>
通知の有効化も SQL でやりたいなとか非管理者も通知を受け取りたいな、メールと Web 以外でも通知を受け取りたいなという気持ちではあるが、一旦はこれでなんとかなるので今後のアップデートに期待したい。&lt;/p></description></item><item><title>ElastiCache のノードタイプを変更する際の注意点</title><link>https://kanata2.dev/posts/elasticache-scaleup/</link><pubDate>Fri, 20 Dec 2019 10:00:00 +0900</pubDate><guid isPermaLink="true">https://kanata2.dev/posts/elasticache-scaleup/</guid><description>&lt;p>注意: この記事は &lt;code>aws elasticache list-allowed-node-type-modifications&lt;/code> を知っていれば(ほぼ)読む必要はありません。&lt;/p>
&lt;h3 id="背景">背景&lt;/h3>
&lt;p>今見ているサービスで RI の購入タイミングになったので、m4.4xlarge のものを m5.4xlarge に変更しようという話になりました。&lt;br>
しかし、実際にオペレーションをしたところ変更ができなかったのでスケール時に確認しておくべきことなどを自分用にメモとして残しておきます。&lt;br>
(いやその変更は直接は無理でしょ！と一瞬で分かった方には不要な記事です)&lt;/p>
&lt;h3 id="原因事前にやっておくべきこと">原因・事前にやっておくべきこと&lt;/h3>
&lt;p>結論から述べると、&lt;a href="https://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/Scaling.RedisReplGrps.ScaleUp.html">ドキュメント&lt;/a>に記載してある通り、スケールアップ先として選択可能なノードとそうでないノードが存在します。&lt;br>
AWS CLI であれば &lt;code>aws elasticache list-allowed-node-type-modifications&lt;/code> を使うのが良いです。&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">
$ aws elasticache list-allowed-node-type-modifications --replication-group-id xxxxx
&lt;span class="o">{&lt;/span>
&lt;span class="s2">&amp;#34;ScaleUpModifications&amp;#34;&lt;/span>: &lt;span class="o">[&lt;/span>
&lt;span class="s2">&amp;#34;cache.m4.10xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m5.12xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m5.24xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r3.4xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r3.8xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r4.16xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r4.4xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r4.8xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r5.12xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r5.24xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r5.4xlarge&amp;#34;&lt;/span>
&lt;span class="o">]&lt;/span>,
&lt;span class="s2">&amp;#34;ScaleDownModifications&amp;#34;&lt;/span>: &lt;span class="o">[&lt;/span>
&lt;span class="s2">&amp;#34;cache.m3.2xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m3.large&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m3.medium&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m3.xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m4.2xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m4.large&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.m4.xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r3.2xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r3.large&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r3.xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r4.large&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.r4.xlarge&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.t2.medium&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.t2.micro&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.t2.small&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.t3.medium&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.t3.micro&amp;#34;&lt;/span>,
&lt;span class="s2">&amp;#34;cache.t3.small&amp;#34;&lt;/span>
&lt;span class="o">]&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="なぜ変更できないのか">なぜ変更できないのか&lt;/h3>
&lt;p>ドキュメントには詳細な仕様は明記されていません。&lt;br>
今回のケースでは「別のノードタイプに変更する場合は現在よりメモリの小さいものには変更できない」というルールが存在していてそれに引っかかったのだと思われます。&lt;br>
また、これ以外にも変更に関するルールは存在するようなので、必ず事前に調べておく必要があります。&lt;/p>
&lt;h3 id="どうしても変更したい">どうしても変更したい&lt;/h3>
&lt;p>という場合もあるかと思います。その場合は、&lt;/p>
&lt;ol>
&lt;li>同ノードタイプの現在よりメモリの小さいものに一旦変更&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>例: m4.4xlarge -&amp;gt; m4.2xlarge&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>当初変更予定だったノードタイプに変更&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>例: m4.2xlarge -&amp;gt; m5.4xlarge&lt;/li>
&lt;/ul>
&lt;p>という手順で理論的には変更可能です。(こちらはサポートケースでも案内されました)&lt;/p></description></item><item><title>Hugo + GitHub Pages + GitHub Actions でこの記事を世に届けている</title><link>https://kanata2.dev/posts/hugo-and-github-pages-and-github-actions/</link><pubDate>Wed, 11 Sep 2019 12:10:48 +0900</pubDate><guid isPermaLink="true">https://kanata2.dev/posts/hugo-and-github-pages-and-github-actions/</guid><description>&lt;p>最近自分のアカウントも GitHub Actions が有効になったので、&lt;br>
早速使ってみようと思いこの GitHub Pages を Actions でリリースするようにしてみた。&lt;br>
実際の YAML を見るのが早いと思うので貼る。以下の通り。&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">publish&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">push&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">branches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">develop&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">build-deploy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">build&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">peaceiris/actions-hugo@v0.58.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>--&lt;span class="l">gc --minify --cleanDestinationDir&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">deploy&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">peaceiris/actions-gh-pages@v2.2.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">ACTIONS_DEPLOY_KEY&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.ACTIONS_DEPLOY_KEY }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">PUBLISH_BRANCH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">PUBLISH_DIR&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">./public&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>すでに世に出回っている Action が便利なのでそれを使うだけの記事になってしまった。&lt;/p>
&lt;h4 id="参考">参考&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://github.com/marketplace/actions/deploy-action-for-github-pages">https://github.com/marketplace/actions/deploy-action-for-github-pages&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>ハローワールド</title><link>https://kanata2.dev/posts/my-first-post/</link><pubDate>Tue, 10 Sep 2019 00:35:16 +0900</pubDate><guid isPermaLink="true">https://kanata2.dev/posts/my-first-post/</guid><description>&lt;p>文章を書きたいけどどこに書こうか迷った結果 GitHub Pages にたどり着いた。&lt;/p></description></item></channel></rss>